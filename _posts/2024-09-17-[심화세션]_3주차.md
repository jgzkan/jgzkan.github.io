---
layout: post
title: "[심화세션]_3주차"
published: true
date: 2024-10-01
math: true
categories: 
tags: KHUDA 심화세션
---


## 주교재 ##
















## 부교재 ##

## [6장] 다양한 가설검정 ##

### 6.1 다양한 가설검정 ###

![img1](assets/img/DBRS_week3/img1.png)

> 가설검정 해석의 기본 흐름
![img2](assets/img/DBRS_week3/img2.png)


- 분할표: 각 상태에 몇 개 데이터가 있는지를 나타내는 표
- 산점도: x-y 평면에 데이터를 점으로 찍어 양적 변수간의 관계를 표현한 그림

![img3](assets/img/DBRS_week3/img3.png)


> 데이터 유형 먼저 확인

- 데이터 유형이 양적 변수인지 질적 변수인지에 따라 해석 방법이 달라진다.
- 표본의 수(집단의 수)도 분석 방법 선택에서 중요한 요소다. 

![img4](assets/img/DBRS_week3/img4.png)


> 양적 변수의 성질

- 모수검정: 모집단이 수학적으로 다룰 수 있는 특정 분포를 따른다는 가정을 둔 가설검정
- 비모수검정: 모집단분포가 특정 분포라고 가정할 수 없는 경우, 예를 들어 좌우 비대칭 분포나 이상값이 있는 분포 -> (예시 이미지)

- 정규성: 데이터가 정규분포로부터 얻어졌다고 간주할 수 있는 성질

![img5](assets/img/DBRS_week3/img5.png)

- 등분산성: 분산이 같은 성질, 집단 간 평균값을 비교하는 경우에 집단끼리 분산이 동일하다고 가정하는 경우가 많음
![img6](assets/img/DBRS_week3/img6.png)


### 6.2 대푯값 비교 ###

- 일표본 t검정: 2가지 조건을 비교x, 어떤 평균값의 모집단에서 표본을 얻었는가를 조사하는 것

> 가설 예시
- 귀무가설: 모집단의 평균은 m=00 이다.
- 대립가설: 모집단의 평균은 m=00이 아니다. 

여기서 00은 연구의 배경으로서 의미가 있는 값을 고려해야만 한다. 

예를 들어, '한국인 성인 남성의 평균 키는 170cm이다'와 같은 맥락이 없는 가설은 가설검정보다 신뢰구간을 구하는 방법이 적절하다.

![img7](assets/img/DBRS_week3/img7.png)

95% 신로ㅓㅣ구간을 구하는 것과 @=0/05의 유의수준으로 귀무가설을 검정하는 것은 x_bar에서 생각할지 귀무가설 m=00에서 생각할지의 차이뿐으로, 동전의 양면과 같은 관계다. 


- 이표본 t검정

이표본 t검정에서는 2개 집단의 평균값을 비교한다. 

![img8](assets/img/DBRS_week3/img8.png)

t검정은 모수검정으로 분류되는 검정 방법이기에 데이터에 정규성이 있어야 한다. 
일반적인 t검정에서는 등분산성을 가정한다. 

만약, 분산이 일치하지 않는 경우에는 **웰치의 t검정**을 이용한다.

**웰치의 t검정**은 2개 집단의 분산이 다르더라도 사용 가능하다. 단, 정규성은 보장되어야 한다.


- 대응 관계가 없는 검정과 대응 관계가 있는 검정
![img9](assets/img/DBRS_week3/img19.png)

대응 관계가 있는 경우는 한 피험자의 혈압을, 약을 복용하기 전후로 총 두 차례 검사한다. 

*대응 관계가 있는 데이터*일 때는 똑같이 *대응 관계가 있는 검정*을 이용하는 편이 좋다. 
그러면 제2종 오류가 발생할 확률이 낮아지며, 검증력도 오르는 경향이 있다. 

> 적절치 않은 검정을 사용한다면?:
- 정규분포에서 데이터를 얻었다고 볼 수 없을 때 t검정을 사용하면, 유의수준 @를 0.05로 설정하더라도 제1종 오류가 일어날 확률이 0.05가 아니게 된다. 이는 가설검정에서 큰 문제가 된다. 
- 한편, p값이 (그 정의인) 귀무가설 하에서 관찰된 값 이상으로 극단적인 값을 얻을 수 있는 확률보다 커지게 되면, 제1종 오류를 일으킬 확률이 설정한 값보다 작아진다. 그만큼 제2종 오류가 일어나기 쉬우며, '보수적인 방법'이라 표현되기도 하지만 이 역시 문제다. 
- 때문에 데이터 성질에 맞춰 적절한 검정 방법을 선택하는 것이 중요하다.


- 정규성 조사

정규성 조사법: Q-Q 플롯, 샤피로-윌크 검정, 콜모고로프-스미르노프 검정 등

![img10](assets/img/DBRS_week3/img10.png)

위의 전제를 잉요해 가설검정을 시행하자. 
p>=0.05라면, 정규성이 있고
p<0.05라면, 정규성이 없다고 판단하는 경우가 많다. 
단,p>0.05라 귀무가설을 기각할 수 없다고 해도 귀무가설이 옳다는 증거가 되지는 않기에, 정규분포에서 데이터를 얻었다고 적극적으로 주장할 수 없다는 점에 유의해야 한다.

또한, 2개 집단이 있을 때는 먼저 각 집단의 정규성을 조사하는 검정을 실시하고 t검정을 이용하게 되므로 가설검정 작업을 반복해 버리는 *검정 다중성 문제*가 생긴다. 
때문에 데이터가 정규분포에서 얻어졌는지 여부를 조사하는 가장 좋은 특정 방법은 없다고 할 수 있다. 
더군다나 현실의 데이터 대부분은 엄밀한 정규분포로부터 나온 것이 아니기에 표본크기가 큰 경우에는 조금만 정규분포에서 벗어나도 정규분포에서 얻은 것이 아니라 판단되고 만다. 


- 등분산성 조사

분산이 같다는 가설을 조사하는 검정으로 **바틀렛 검정**이나 **레빈 검정**이 있다.

![img11](assets/img/DBRS_week3/img11.png)

이때 위의 전제를 이용하여 가설검정을 시행한다. 
p>=0.05라면 등분산, p<0.05라면 부등분산이라 판단하지만, 
정규성 검정과 마찬가지로 p>0.05라 해도 적극적으로 분산이 같다고 주장할 수는 없다. 

> 비모수검정의 대푯값 비교

각 집단 데이터에 정규성이 없는 경우에는 비모수검정으로 분류되는 방법을 사용하는 것이 권장된다. 
이때는 평균값 대신 분포의 위치를 나타내는 대푯값에 주목하여 해석해야 하는데, 대표적인 방법으로는 **윌콕슨 순위합 검정**이 있다.
이는 평균값 대신 데이터 값의 순위에 기반하여 검정을 실시한다. 

**맨-휘트니 U 검정**도 같은 방법이다. 이 방법을 사용하려면 비교할 2개 집단의 분포 모양 자체가 같아야 한다. 즉, 분포는 정규분포가 아니더라도 괜찮지만, 분산이 다르다면 문제가 생길 수 있다. 
![img12](assets/img/DBRS_week3/img12.png)

분석 결과 p>=0.05라면 '2개 모집단의 위치가 다르다 할 수 없다'로,
p<0.05라면 '2개 모집단의 위치가 다르다'로 판단한다. 

그 밖에 2개의 모집단을 비교하는 방법으로는 **플리그너-폴리셀로 검정**과 **브루너-문첼 검정**이 있다. 
이 방법은 2개 모집단의 분포 형태가 같지 않을 때도 사용할 수 있는 비모수검정 방법이다. 
(단, 극단적으로 분포 형태가 다른경우는 제1종 오류가 발생할 확률이 설정한 @와는 달라지므로 주의해야 한다.)


>분산분석(3개 집단 이상의 평균값 비교)

3개 이상 집단의 평균값을 비교하는 방법이 **분산분석(ANOVA, Analysis of variance)**이다. 
예를 들어, 비료 A, B, C에 따라 식물 줄기의 길이에 차이가 생기는지를 조사할 때는 분산분석을 활용하게 된다. 

![img13](assets/img/DBRS_week3/img13.png)

![img14](assets/img/DBRS_week3/img14.png)

- 분산분석의 원리
먼저 집단의 차이를 무시하고 모든 데이터를 이용해 전체 평균을 계산하자. 
여기서 x_bar = 35.2이다. 다음으로, A,B,C 각 집단의 평균을 계산한다. 그리고 각 데이터 x_i와 x_bar의 차이를 구한다. 
예를 들어, x_i가 C군 데이터일 때, 
![img15](assets/img/DBRS_week3/img15.png)
이처럼 계산하여 각 데이터의 전체 평균과의 차이를 집단 내의 분산과 집단 간의 분산으로 분해할 수 있다. 

![img16](assets/img/DBRS_week3/img16.png)

집단 내 변동은 동일 조건에서의 데이터 퍼짐이므로 원래 존재하는 무작위 오차의 크기를 나타낸다. 
이와 달리 집단 간 변동은 집단 간의 차이를 나타내며, 집단 간 차이가 있다면 큰 데이터 퍼짐을, 반대로 차이가 없다면 집단 내 편차와 같은 정도로 작은 데이터 퍼짐을 기대할 수 있다. 

구체적으로 F값 = (평균적인 집단 **간** 변동)/(평균적인 집단 **내** 변동)을 계산하여 검정통계량을 만든다. 이 양은 귀무가설이 올바르다는 가정하에, F분포를 따른다. 
이 분포에서 관찰한 F값 이사응로 극단적인 값이 나올 확률이 p값이다. F값이 유의수준보다 오른쪽에 있다면 유의수준 @=0.05에서 통계저긍로 유의미한 집단 간 차이가 있다는 것이다.

![img17](assets/img/DBRS_week3/img17.png)

> 자유도: 자유로이 움직일 수 있는 변수의 수. 예를 들어 n=10인 표본에서 표본평균을 계산한 이후에의 자유도는 9

> 다중비교 검정
- 그림 6.2.4의 데이터 예시를 분산분석으로 해석하면 F값은 60.7의 큰 값이며, p값은 10^(-7)보다 작다. 따라서 통계적으로 유의미한 집단 간의 차이가 있으므로, 비료 효과에 차이가 난다는 사실을 알 수 있다. 
- 단, 분산분석의 대립가설은 '적어도 한 쌍에는 차이가 있다'이기에 p<0.05로 대립가설을 채택하더라도 어느 쌍에 차이가 있는지까지는 알 수 없다. 그러므로 어느 쌍에 차이가 있는지 알고 싶다면 다중비교라 불리는 방법을 사용해서 조사해야 한다. 
- 집단이 셋 이상일 때 각 쌍의 차이를 조사하기 위해 유의수준 @=0.05에서 이표본 t검정을 반복해 실행하면, 제1종 오류가 증가하고 마는 문제가 생긴다. 예를 들어 3개 집단이 있을 때, 쌍의 수는 3이다. t검정을 3번 반복하면 적어도 적어도 한 쌍에서 제1종 오류가 일어날 확률은 1-(1-0.95)^3=0.143이 되어, 분산분석 전체에서 설정한 유의수준 @=0.05를 상회해버린다.**집단이 늘어날 수록 쌍은 더 빠르게 증가해 제1종 오류가 일어나기 쉬워진다.*
- 즉 몇 번씩 검정을 반복하는 것을 통해, 실은 차이가 없는데도 차이가 있다고 말하는 잘못이 간단히 일어나게 된다. 이 다중성 문제를 회피하고자 **다중비교 검정**을 이용한다. 다중 비교의 기본 아이디어는 검정을 반복하는 만큼, 유의수준을 엄격한 값으로 변경하는 것이다. 

- 여러가지 다중비교 방법

- **본페로니 교정**: 전체에서 유의수준 @를 설정했을 때의 검정 반복 횟수를 k라 하고, 매 검정에서는 @를 검정 횟수로 나눈값을 기준으로 가설검정을 하는 방법. 무척 간편하여 평균값 비교뿐 아니라 다양한 다중비교에서 사용할 수 있지만 검정력이 낮은 경향이 있어, 정말로 차이가 있을 때에 차이가 있다고 주장하기 어렵다. 

- **튜키검정**: 본페로니 교정에서 검정력을 개선한 방법
![img18](assets/img/DBRS_week3/img18.png)

- **던넷 검정**: 모든 쌍을 비교하는 튜키 검정보다도 검정력 향상

- **윌리엄스 검정**: 집단 간에 순위를 매길 수 있는 경우에 사용하면 검정력이 좋다. 

![img19](assets/img/DBRS_week3/img19.png)

- 언제나 분산분석이 필요할까?
다중비교 검정은 최초에 분산 분석을 실행하고, 도출한 p값이 @보다 작을 때 사용하는 것이 일반적이다. 

- 분산분석과 동일한 원리의 다중비교: 분산분석에서의 '통계적으로 유의미하다/유의미하지 않다'의 결과가 다중비교 결과와 일치한다.
- 분산분석과 다른 원리의 다중비교: 분산분석에서의 결과와 다중비교 결과가 다를 때가 있다. 

이러한 경우 분산분석을 실행하지 않고, 다중비교만 실행하는 순서를 따라도 문제없다. 섣불리 분산분석 -> 다중비교를 실행해 버리면, 앞서 본 검정의 다중성 문제가 불거지게 된다. 

본페르니 검정, 튜키 검정, 던넷 검정, 윌리엄스 검정은 분산분석과는 다른 원리이므로 분산분석 없이 단독으로 수행해도 문제 없다. 

- 3집단 이상의 비모수 검정

분산 분석은 모수검정으로 분류된다. 따라서 각 집단의 데이터에는 정규성이 있어야 한다. 
정규성이 없는 집단이 있다면 크러스컬-월리스 검정을 사용하는 것이 좋다. 
비모수 다중비교 방법도 고안되어 있는데, 튜키 검정에 상응하는 것이 **스틸-드와스 검정**, 던넷 검정에 상응하는 것이 **스틸 검정**이다. 


### 6.3 비율 비교 ###

양적 변수에서 모집단의 평균값을 추정하거나 모집단을 대상으로 가설을 세워 가설검정을 시행한 것처럼 범주형 변수에서도 확률 p를 추정하거나 p에 관련된 가설을 세워 검정할 수 있다. 

> 이항검정

하나의 범주가 확률 P, 또 하나의 범주가 확률 1-P로 나타나는지를 조사하는 **이항검정**이라는 방법을 사용한다. 아래와 같이 p=1/2로 귀무가설과 대립가설을 세우고 치우치지 않은 동전인지 알아보자. 

![img20](assets/img/DBRS_week3/img20.png)

귀무가설이 옳다고 가정하고 앞면이 21번, 뒷면이 9번  이상으로 극단적인 값이 나올 확률인 p값을 계산하자. 확률 P로 앞면이, 1-P로 뒷면이 나온다면 N번 동전을 던졌을 때 m번 앞면이 나올 확률은 이항분포를 따른다. 여기서는 p=0.043이므로 유의수준 @=0.05에서 통계적으로 유의미하게 한쪽으로 치우쳤다고 판단할 수 있다. 즉, 가설검정의 관점에서는 편향된 동전이라 말할 수 있는 것이다. 

![img21](assets/img/DBRS_week3/img21.png)


> 카이제곱검정: 적합도검정

이항검정은 범주가 2개일 때만 이용할 수 있다. 범주가 더 많을 때나 일반적인 이산확률분포에 이항검정의 방식을 적용하고 싶다면 **카이제곱검정**의 일종인 **적합도검정**을 이용함으로써, 특정 이산확률분포에서 얻은 데이터인지를 조사할 수 있다. 

예를 들어 정상 주사위라면 1/6의 확률로 각 눈이 나오는 이산균등분포를 보인다. 

일반적으로 카이제곱검정의 적합도검정은 다음과 같이 해석한다. 
![img22](assets/img/DBRS_week3/img22.png)

1. 카이제곱검정의 적합도검정에서는 먼저 귀무가설의 확률분포에서 얻을 수 있는 기대도수(전체 개수 * 각 확률)를 계산한다. 
2. 각 눈의 (실제 출현도수-기대도수)^2/(기대도수)를 계산하고, 이를 더한 값을 구한다. 이 검정통계량을 카이제곱값이라 부르는데, 귀무가설이 옳다면 이는 카이제곱분포라는 확률분포를 따른다. 이 분포 안에서 실제로 얻은 카이제곱 값의 위치를 구하여 p 값을 도출한다. 

예시 데이터에서는 p=0.017이 되어 대립가설을 채택하므로, 통계적으로 유의미하게 이 주사위는 올바른 주사위가 아니라고 판단할 수 있다. 

![img23](assets/img/DBRS_week3/img23.png)

각 눈이 1/6씩 나온다는 균등한 확률 분포 말고도 임의의 확률분포도 사용할 수 있다. 
예를 들어 한국인의 혈액형 비율이 A:B:O:AB=34:27:28:11 이라고 할 때, 일본 역시 이 비율을 따르는지 조사하려면 각 혈액형 확률을 0.34, 0.27, 0.28, 0.11로 한 확률분포를 이용하면 된다. 

> 카이제곱검정: 독립성검정

이항검정이나 카이제곱검정의 적합도 검정은 '데이터 vs 모집단'의 확률 분포를 비교한 것이다.

그런데 범주형 변수에서도 2개 변수의 관계를 조사해야 할 때가 있다. 

상수리나무와 굴밤나무를 관찰하여 사슴벌레의 개체 수를 암수별로 관찰한다고 하자. 여기서 문제는 나무 종류에 따라 암수의 비율이 달라지는지 여부다. 
2개의 범주형 변수 데이터는 분할표로 정리할 수 있는데, 분할표 가로 방향과 세로 방향의 2개 변수에 주목하자면, 한쪽 변수의 범주가 바뀌었을 때 다른 쪽 변수의 범주 비율이 달라지지 않을 때, 2개 변수는 독립적이라고 말할 수 있다. 

이를 조사하려면 독립성검정을 이용한다.
여기서도 카이제곱값이 등장하여 카이제곱분포를 이용하므로, 카이제곱검정의 독립성검정이라 부른다. 이 검정에서는 아래와 같이 해석한다. 
![img24](assets/img/DBRS_week3/img24.png)

구체적인 계산은 (실제 출현도수-기대도수)^2/(기대도수)를 이용하므로, 적합도 검정과 많이 닮아있다. 기대도수는 분할표의 각 행과 열의 합을 계산한 뒤, 열의 합 비율을 기준으로 다시 배분하여 얻을 수 있다. 

![img25](assets/img/DBRS_week3/img25.png)

기대도수를 얻었다면 계산식에 따라 카이제곱값을 계산한다. 이 예에서 카이제곱값은 4.33인데, 분포 안의 위치를 구하면 p값=0.037이 되므로 대립가설이 채택된다. 즉, 사슴벌레 암수의 비율이 나무 종류에 따라 다르다는 결론을 내릴 수 있다. 

그 밖의 독립성검정으로는 피셔의 정확검정이 있다. 이는 이항검정에서 본 것처럼 초기하분포를 이용하여 모든 경우의 확률을 계산하는 방법이다. 



## [7장] 상관과 회귀 ##


### 7.1 양적 변수 사이의 관계를 밝히다 ###

양적변수 사이의 관계를 분석하는 또 다른 방법으로 상관과 회귀가 있다. 

2개의 양적 변수로 이루어진 데이터를 생각해보자. 여기서 각 대상(학생)으로부터 수학과 과학 양쪽의 데이터를 얻어 쌍을 만들었다는 점이 중요하다. 

> 산점도

1개의 변수를 x축 값으로, 다른 1개의 변수를 y축 값으로 하여 2차원 평면 위에 점으로 나타낼 수 있다. 이렇게 2차원 평면 위에 점으로 대상을 나타낸 그래프를 산점도라 한다. 

![img26](assets/img/DBRS_week3/img26.png)


> 상관

산점도를 이용하여 시각화하면 두 변수가 어떤 관계에 있는지 대략적으로 파악할 수 있다. 

![img27](assets/img/DBRS_week3/img27.png)

두 변수 사이의 관계성을 상관이라 한다. 이는 양적 변수에 한정되지 않는 개념으로, 2개의 확률변수 또는 데이터 사이의 관계성을 의미한다. *다만, 상관이 있다고 해서 원인과 결과를 뜻하는 인과관계가 있는지까지는 알 수 없다.*

> 회귀

y=f(x)라는 함수를 통해 변수 사이의 관계를 공식화하는 것을 회귀라 한다. 

여기서 x를 설명변수 또는 독립변수, y를 반응변수 또는 종속변수라 한다.

상관과 다르게, 회귀에는 'x에서 y'라는 방향성이 있는데 이는 통상 회귀에서 y가 확률변수이기 때문이다. 다르게 보면, f(x)는 확률분포의 파라미터, 특히 평균을 결정하는 역할을 하는 고정부분인 것이다. 

회귀분석에서는 얻은 데이터에 잘 들어맞는 f(x)를 추정하고, 두 변수 간 관계를 구한다. 


### 7.2 상관관계 ###


